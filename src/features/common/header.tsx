import {
  AppBar,
  Box,
  Button,
  createStyles,
  Divider,
  IconButton,
  Link,
  List,
  ListItemText,
  makeStyles,
  Popover as MaterialUIPopover,
  Theme,
  Toolbar,
  Typography,
} from "@material-ui/core";
import InfoIcon from "@material-ui/icons/Info";
import { useStore } from "effector-react";
import React from "react";

import { AuthTabs } from "../../auth/auth";
import { tabIndexChanged, authModalOpened } from "../../auth/auth-model";
import { $session, $isAuthenticated, sessionDropped } from "./session-model";
import { Link as RouterLink } from "react-router-dom";
import { mapRole } from "../../lib/mapRole";

const useStyles = makeStyles((theme: Theme) =>
  createStyles({
    item: {
      marginRight: theme.spacing(2),
    },
    nav: {
      display: "flex",
      flexGrow: 1,
      padding: "0 16px",
    },
    btn: {
      textTransform: "capitalize",
    },
    text: {
      fontSize: "1.1rem",
    },
  })
);

export const Header = () => {
  const classes = useStyles();
  const currentUser = useStore($session);
  const isAuthenticated = useStore($isAuthenticated);

  const handleOpenAuthModal = (index: number) => {
    return (_: any) => {
      tabIndexChanged(index);
      authModalOpened();
    };
  };

  return (
    <React.Fragment>
      <AppBar
        position="static"
        style={{ backgroundColor: "#fff", color: "black", boxShadow: "none" }}
      >
        <Toolbar style={{ padding: "0 48px" }}>
          <Box>
            <Link component={RouterLink} to="/">
              <svg height="5.5rem" viewBox="0 0 360 600" fill="#2a324c">
                <path
                  fillRule="evenodd"
                  clipRule="evenodd"
                  d="M149.108 150.521c-.028-4.133-.082-4.732.299-5.086.38-.353 1.196-.462 1.958-.217.76.245 1.468.843 1.917 3.006.449 2.163.64 5.89.648 8.981.007 3.09-.167 5.543-.229 7.201-.061 1.658-.009 2.523-.751 3.402-.743.879-2.278 1.775-3.046 2.142-.769.366-.769.203-.769-3.713 0-3.915 0-11.583-.027-15.716zM177 323.88L163.343 344H177v-20.12zm137.189-9.329c-.66 2.281-1.873 4.407-5.467 10.838a4219.708 4219.708 0 0 0-16.762 30.275c-7.189 13.113-15.594 28.606-22.277 40.909-6.684 12.304-11.643 21.417-17.01 30.783a748.012 748.012 0 0 1-17.014 28.251c-5.873 9.267-11.846 18.178-18.074 26.683-6.228 8.507-12.709 16.607-17.721 22.329-5.014 5.722-8.557 9.061-11.646 11.877-3.089 2.813-5.721 5.099-9.468 6.243-3.746 1.142-8.607 1.142-12.91-.76-4.304-1.902-8.051-5.708-12.911-11.003-4.861-5.294-10.836-12.079-15.797-18.915-4.961-6.834-8.911-13.72-13.113-20.808-3.535-5.961-7.252-12.081-11.957-21.763l-1.207-.098c-10.875-.879-16.825-1.359-24.521-2.018-7.696-.658-17.139-1.493-21.961-1.861-4.822-.367-5.025-.265-6.189-4.316-1.166-4.05-3.292-12.251-4.753-16.81-1.461-4.557-2.257-5.468-.131-6.024 2.126-.557 7.175-.759 12.89-1.417 5.715-.658 12.094-1.772 20.348-3.544a340.908 340.908 0 0 0 9.083-2.078c-1.925-4.756-3.738-9.283-5.321-13.233-5.216-13.011-7.95-19.796-10.633-27.745-2.684-7.949-5.316-17.063-7.139-24.15-1.822-7.088-2.834-12.151-3.746-18.177-.911-6.025-1.722-13.011-1.787-20.293-.066-7.28.612-14.854 2.181-21.74 1.57-6.886 4.029-13.083 6.475-17.396 2.446-4.314 4.877-6.744 6.093-7.96 1.215-1.213 1.215-1.213 1.215-22.934s0-65.162.102-86.883c.101-21.72.304-21.72.81-22.327.506-.608 1.316-1.823 2.936-3.444 1.621-1.62 4.051-3.646 5.823-5.316 1.772-1.67 2.886-2.987 3.646-4.202.758-1.216 1.165-2.33.911-3.646-.253-1.316-1.164-2.834-.709-4.455.456-1.621 2.279-3.341 6.025-5.924 3.748-2.582 9.417-6.025 15.442-9.367 6.026-3.341 12.405-6.581 19.384-9.652 6.978-3.072 14.556-5.974 20.783-8.1a204.698 204.698 0 0 1 13.646-4.151c2.539-.675 2.742-.675 2.843 12.185.103 12.859.103 38.579.051 51.438-.051 12.86-.152 12.86 1.173 12.05 1.326-.811 4.077-2.43 7.063-4.05s6.211-3.24 10.151-5.164c3.94-1.924 8.599-4.151 15.231-6.734 6.631-2.582 15.24-5.518 23.947-8 8.71-2.479 17.519-4.505 25.063-6.075 7.545-1.57 13.822-2.683 18.055-3.075 4.23-.392 6.418-.063 7.582-.012 1.164.05 1.309-.179 1.379 30.744.072 30.923.072 92.997-.08 124.133-.152 31.138-.457 31.34.455 31.442.912.101 3.039.101 5.773.051 2.732-.051 6.076-.152 9.063-.152s5.621.101 8.002.758c2.379.658 4.502 1.874 5.717 3.242 1.215 1.365 1.521 2.885 1.623 4.859.098 1.975-.001 4.404-.66 6.682zM98.062 398.329c1.449 3.688 3 7.447 4.59 11.173.642-.178 1.28-.359 1.92-.543a421.163 421.163 0 0 1-4.668-11.354c-6.017-15.311-9.611-27.78-12.777-39.241-3.12-11.296-5.212-19.297-6.674-26.762a168.57 168.57 0 0 1-2.755-20.988c-.427-6.315-.396-11.213.098-15.879.517-4.861 1.542-9.415 2.965-13.171 1.232-3.25 2.854-6.21 5.258-9.6 1.955-2.757 3.988-5.196 4.966-6.369 1.242-1.491 1.242-1.491 1.242-23.519 0-21.101 0-65.009.051-86.677.046-19.626.138-21.301.645-21.914l.471-.579c.727-.898 1.824-2.256 2.933-3.326.825-.796 1.705-1.479 2.636-2.201.625-.485 1.28-.994 1.973-1.575 1.777-1.492 3.949-3.571 4.967-6.432.654-1.835.804-3.944.925-5.639.059-.827.115-1.608.218-2.177.234-1.298.645-1.528 2.003-2.291l.155-.087a186.232 186.232 0 0 0 6.263-3.731l1.031-.642c2.265-1.411 4.831-3.011 8.267-4.836 3.522-1.873 8.409-4.218 13.76-6.603 5.188-2.311 9.133-3.908 13.191-5.337 5.208-1.834 10.48-3.342 11.484-3.626.208-.059.455-.129.627-.158.336.874.321 4.525.297 10.363l-.006 1.596c-.025 6.656-.038 16.612-.051 26.563-.013 9.959-.025 19.913-.051 26.548l-.009 2.284c-.038 8.873-.043 10.236.702 10.985.244.246.568.38.913.38.481 0 .877-.251 1.319-.532.679-.43 1.673-1.048 2.852-1.781a863.526 863.526 0 0 0 5.21-3.256l.581-.366c3.173-2.004 6.455-4.077 13.037-7.489 4.308-2.232 15.779-7.991 29.236-13.234 11.184-4.356 23.668-8.331 33.396-10.633 9.344-2.213 15.662-2.749 19.065-3.038l3.337-.285c.077 2.114.077 9.179.077 28.943 0 29.236 0 90.07-.148 127.23a3974.19 3974.19 0 0 1-.156 24.036c.666-.105 1.324-.204 1.981-.301.069-6.755.115-14.561.153-23.727.148-37.164.148-98.001.148-127.243 0-14.723 0-22.114-.029-25.965-.036-4.548-.04-5.023-1.201-5.023l-4.338.363c-3.445.292-9.859.836-19.346 3.083-9.813 2.322-22.395 6.327-33.659 10.714-13.059 5.088-24.043 10.53-29.428 13.321-6.657 3.451-10.125 5.641-13.184 7.573l-.58.366a878.679 878.679 0 0 1-5.199 3.249c-1.066.663-1.983 1.232-2.67 1.666-.124-1.313-.111-4.328-.091-9.029l.009-2.284c.025-6.637.038-16.593.051-26.554.013-9.95.025-19.904.051-26.558l.006-1.596c.037-9.027.045-10.906-.919-11.873a1.69 1.69 0 0 0-1.233-.492c-.419 0-.842.12-1.29.246-1.014.287-6.339 1.811-11.604 3.664-4.111 1.449-8.101 3.063-13.339 5.397-5.391 2.403-10.321 4.77-13.883 6.663-3.497 1.858-6.094 3.477-8.385 4.905l-1.027.639a181.264 181.264 0 0 1-6.191 3.688l-.152.085c-1.442.81-2.582 1.449-2.982 3.665-.122.675-.182 1.508-.245 2.389-.118 1.657-.251 3.535-.814 5.116-.859 2.412-2.79 4.249-4.375 5.579-.673.565-1.308 1.057-1.915 1.528-.974.756-1.894 1.47-2.796 2.34-1.197 1.155-2.341 2.57-3.098 3.506l-.469.576c-.977 1.181-1.036 1.251-1.087 23.156-.051 21.671-.051 65.58-.051 86.682 0 20.714-.022 21.338-.783 22.251-.993 1.192-3.061 3.671-5.06 6.491-2.506 3.533-4.2 6.63-5.494 10.044-1.482 3.912-2.548 8.636-3.083 13.663-.507 4.785-.539 9.787-.104 16.221a170.645 170.645 0 0 0 2.788 21.236c1.474 7.526 3.576 15.565 6.708 26.908 3.179 11.514 6.79 24.042 12.843 39.442zm154.944-205.098c0 2.362 0 2.733-2.303 4.248-2.303 1.514-6.906 4.174-9.293 5.811-2.385 1.637-2.549 2.252-2.631 3.181-.083.929-.083 2.171.471 2.94.557.77 1.668 1.067 5.135-.465 3.467-1.532 9.289-4.894 12.199-6.854 2.912-1.958 2.912-2.516 2.912-14.263 0-11.746 0-34.683-.033-46.272s-.098-11.832-1.338-11.628c-1.244.203-3.662.851-4.824 1.176-1.162.324-1.064.324-1.016 7.232.049 6.909.049 20.727.008 27.676-.043 6.95-.123 7.032-.566 7.305a15.66 15.66 0 0 1-2.105 1.093c-.857.354-1.761.596-2.327.603-.567.008-.796-.22-.908-7.169-.113-6.95-.113-20.621-.263-27.497-.15-6.876-.449-6.956-1.411-6.778-.962.177-2.587.614-3.476 1.034-.889.419-1.041.824-1.105 1.331-.064.507-.043 1.115-.033 7.949.014 6.835.014 19.898.014 27.645 0 7.746 0 10.174.467 11.66.469 1.485 1.408 2.026 3.094 1.597 1.682-.432 4.113-1.834 5.533-2.742 1.422-.907 1.834-1.319 2.162-1.455s.572.005.832.314c.26.307.533.782.67 3.197.135 2.415.135 6.769.135 9.131zm-25.507-30.724c.015-10.762.044-10.868 1.281-11.628 1.238-.759 3.687-2.172 4.937-2.879 1.25-.708 1.301-.708 1.324-2.504.027-1.797.027-5.393.027-7.139 0-1.747 0-1.646-4.039.358-4.037 2.004-12.112 5.912-16.221 7.898-4.107 1.987-4.246 2.055-4.139 3.835.107 1.78.462 5.273.764 6.931.301 1.657.551 1.478 1.633.834s2.997-1.749 4.594-2.475c1.598-.728 2.877-1.076 3.529-.941.654.134.682.749.744 11.652.064 10.903.162 32.094.195 42.629.031 10.537 0 10.418.93 9.812.931-.605 2.824-1.698 3.723-2.245.897-.548.802-.548.752-11.254-.047-10.707-.047-32.123-.034-42.884zM193 346v-2h-14v-27.577L160.743 344h-6.907l-37.767 41.26-.069.521V402h2v-15.443L154.702 346H193zm-20 12v9h5v-9h-5zm-14 0v9h6v-9h-6zm-12 6v9h3v-9h-3zm-10 12v7h3v-7h-3zm-11 12v7h3v-7h-3zM98.847 195.458c-.032 12.498-.096 12.724 2.953 11.171 3.048-1.551 9.211-4.884 12.405-6.762 3.193-1.878 3.417-2.303 3.065-3.303-.351-.999-1.278-2.574-2.018-3.276-.739-.703-1.292-.534-2.689.158-1.398.69-3.641 1.903-4.853 2.559-1.212.655-1.392.752-1.481-8.915-.09-9.667-.09-29.099-.128-38.949-.039-9.85-.115-10.118 1.038-10.897 1.154-.779 3.537-2.067 4.781-2.795 1.243-.728 1.347-.895 1.398-2.107.051-1.212.051-3.469-.135-4.62-.187-1.153-.562-1.198-.935-1.246-4.488 2.427-8.976 4.854-11.203 6.01-2.229 1.155-2.197 1.043-2.18 13.372.015 12.33.015 37.101-.018 49.6zm33.57-65.075c-.023 7.812-.023 23.16-.023 33.515 0 10.356 0 15.72-.026 18.428-.025 2.709-.076 2.761 1.197 2.026 1.272-.736 3.867-2.26 5.173-3.023 1.308-.763 1.327-.766 1.335-.813.01-.045.009-.132-.006-11.503-.015-11.372-.047-34.027-.153-45.413-.105-11.385-.287-11.502-1.364-11.509-1.078-.006-3.053.098-6.505 1.979-3.455 1.881-8.388 5.54-10.826 7.42-2.438 1.88-2.382 1.98-2.353 13.782.028 11.803.028 35.307.05 47.079.022 11.772.067 11.811 1.327 11.096 1.259-.716 3.734-2.186 5.016-3.092 1.282-.907 1.373-1.251 1.417-11.792.045-10.54.045-31.277.045-41.775 0-10.499 0-10.759.969-11.515.97-.755 2.91-2.004 3.854-2.49.944-.489.896-.212.873 7.6zm15.392 4.534c.033-1.639.291-2.916 1.706-3.929s3.984-1.764 5.61-3.592c1.625-1.831 2.305-4.74.429-4.82-1.876-.081-6.307 2.667-8.604 4.483-2.298 1.816-2.464 2.697-2.546 10.78-.083 8.082.163 21.487.271 31.112.098 8.673-.472 8.499 1.282 7.76.192-.081.414-.169.666-.253 2.557-.847 5.911-2.693 8.082-4.072s3.467-2.451 3.85-7.393c.381-4.94-.152-13.751-.988-18.591-.838-4.84-1.979-5.71-3.237-6.083-1.258-.374-2.633-.25-3.679-.126-1.047.122-1.768.243-2.223-.698-.458-.939-.651-2.939-.619-4.578zm11.117 52.253c1.375-.809 4.177-2.427 5.536-3.308 1.36-.88 1.276-1.026 1.234-2.343-.042-1.318-.042-3.809-.135-5.409-.093-1.599-.279-2.307-2.705-1.315-2.424.991-7.087 3.684-9.441 5.051-2.355 1.366-2.401 1.407-2.424 12.77-.022 11.362-.022 34.045-.022 45.412 0 11.366 0 11.417 1.098 10.809 1.099-.61 3.296-1.878 4.41-2.486 1.113-.607 1.145-.554 1.16-10.172.015-9.619.015-28.91-.011-38.554-.026-9.646-.077-9.646 1.3-10.455zm37.977 4.86c1.897-5.316 2.403-5.265 2.655-4.986.254.279.251.785.251 7.848s-.007 20.682.042 27.521c.049 6.838.133 6.895 1.35 6.249 1.215-.645 3.521-1.991 4.688-2.604 1.166-.61 1.11-.483 1.11-12.926v-49.91c0-12.455.056-12.354-.478-12.304-.531.051-1.541.051-2.503.481-.963.432-1.824 1.291-4.253 9.185-2.431 7.893-6.431 22.819-8.505 30.261-2.078 7.443-2.229 7.403-2.533 7.382-.305-.021-.761-.021-2.836-5.083-2.076-5.063-5.771-15.188-7.669-20.252-1.9-5.063-2.001-5.063-2.989-4.531-.987.531-2.86 1.594-3.975 2.329-1.114.735-1.468 1.14-1.645 13.265-.177 12.126-.177 35.974-.177 47.948 0 11.974 0 12.075 1.03 11.53 1.031-.544 3.092-1.734 4.104-2.339 1.011-.607.973-.628.955-8.539-.02-7.912-.02-23.711.147-31.708.166-7.996.5-8.188.813-8.433.313-.244.61-.538 2.596 3.836s5.664 13.419 7.502 17.94c1.838 4.522 1.838 4.522 3.484-.82 1.648-5.34 4.938-16.024 6.836-21.34zm31.966 256.964c-.909.352-1.876.664-2.92.952a703.22 703.22 0 0 1-5.022 7.938c-7.335 11.419-13.689 20.501-19.996 28.584-5.182 6.64-9.956 12.127-14.192 16.309-3.698 3.651-6.804 6.131-9.495 7.579-2.559 1.375-4.325 1.653-6.499 1.035-1.951-.559-4.554-1.924-10.334-8.081-5.108-5.439-13.292-15.265-20.062-24.953-5.58-7.981-10.195-15.845-16.331-27.906l-2.313-.185c6.458 12.77 11.219 20.923 17.022 29.226 6.826 9.769 15.084 19.682 20.241 25.174 5.77 6.145 8.663 7.893 11.234 8.629a9.32 9.32 0 0 0 2.59.378c1.682 0 3.395-.5 5.391-1.574 2.859-1.538 6.113-4.127 9.947-7.913 4.296-4.241 9.129-9.792 14.362-16.5 6.345-8.131 12.732-17.26 20.102-28.73a706.258 706.258 0 0 0 6.275-9.962zm37.256-61.413c-.027-.709-.482-.709-1.697.734s-3.189 4.329-6.582 9.366c-3.393 5.038-8.201 12.227-12.229 17.544-4.023 5.315-7.266 8.759-10.58 11.645-3.316 2.888-6.709 5.216-10.102 6.811-3.393 1.594-6.783 2.455-12.708 3.214-5.923.76-14.379 1.418-23.567 1.747-9.19.328-19.114.328-38.48.102-19.367-.229-48.175-.684-63.365-1.089s-16.758-.76-17.645-1.139c-.885-.38-1.088-.785-1.29-2.659-.204-1.873-.406-5.214-.507-6.886-.101-1.669-.101-1.669 1.949-1.872 2.051-.203 6.152-.607 10.86-1.292 4.709-.683 10.026-1.645 16-2.886 5.975-1.24 12.606-2.759 19.72-4.91 7.113-2.151 14.709-4.937 20.759-7.267 6.05-2.329 10.556-4.203 15.344-6.788 4.79-2.587 9.86-5.887 14.34-9.202 4.481-3.316 8.372-6.649 11.887-9.911s6.654-6.451 10.275-10.476c3.619-4.025 7.721-8.887 11.948-14s8.582-10.48 13.012-15.113c4.431-4.633 8.936-8.531 15.114-12.253 6.177-3.72 14.023-7.265 19.973-9.163s10-2.152 13.543-2.329c3.545-.177 6.582-.28 9.316.276 2.734.559 5.164 1.773 6.684 3.57 1.518 1.799 2.127 4.178.559 8.713-1.572 4.536-5.316 11.229-8.531 16.629-3.213 5.402-5.893 9.512-8.904 13.835-3.012 4.322-6.355 8.855-9.498 13.176-3.141 4.318-6.078 8.426-9.471 12.478-3.393 4.054-7.24 8.054-11.037 11.927-3.799 3.872-7.545 7.619-10.887 10.657s-6.277 5.367-9.012 7.418-5.266 3.822-7.494 5.189c-2.228 1.367-4.151 2.329-5.113 3.139-.962.811-.962 1.469.734 1.848 1.696.381 5.088.481 8 .355 2.911-.127 5.342-.481 9.113-1.822 3.771-1.342 8.886-3.672 12.479-5.798 3.598-2.126 5.673-4.05 8.381-6.76 2.709-2.708 6.049-6.201 9.164-10.176s6-8.431 8.76-13.039c2.758-4.605 5.391-9.365 8.023-14.453 2.635-5.089 5.268-10.507 8.305-16.962s6.48-13.949 8.91-19.645c2.432-5.696 3.85-9.594 6.076-14.632 2.229-5.038 5.266-11.215 6.76-14.632 1.494-3.418 1.441-4.077-2.584-4.203-4.023-.127-12.021.277-18.352 1.177-6.33.897-10.986 2.288-16.275 4.086-5.287 1.797-11.201 4.001-17.125 6.851-5.924 2.848-11.855 6.342-16.037 9.051-4.181 2.709-6.611 4.633-9.189 6.758-2.578 2.127-5.303 4.456-8.012 7.09-2.709 2.631-5.4 5.568-7.86 8.454-2.46 2.887-4.688 5.722-7.321 9.14s-5.67 7.416-9.391 11.568a125.005 125.005 0 0 1-12.835 12.38c-4.709 3.924-9.721 7.468-15.291 10.76-5.569 3.29-11.696 6.328-17.721 9.036-6.025 2.709-11.949 5.089-18.859 7.316-6.912 2.227-14.81 4.303-20.759 5.772-5.949 1.468-9.949 2.328-14.583 3.088-4.632.759-9.897 1.417-13.847 1.746-3.949.33-6.583.33-7.924.532-1.342.203-1.393.607-.785 4.025.607 3.417 1.874 9.847 2.506 13.063.634 3.214.634 3.214 7.57 3.771 6.938.558 20.809 1.671 32.531 2.431 11.721.76 21.29 1.164 29.466 1.619 8.177.456 14.961.963 23.974 1.542 9.011.579 20.251 1.231 29.214 1.342 8.964.11 15.65-.322 21.333-1.147 5.685-.825 10.362-2.045 14.438-3.395 4.073-1.351 7.542-2.834 11.657-5.573 4.113-2.742 8.873-6.742 13.277-12.463 4.404-5.722 8.455-13.164 11.848-19.367 3.393-6.2 6.127-11.163 7.697-14.353 1.569-3.189 1.973-4.607 1.95-5.316zm-24.548-45.45a669.425 669.425 0 0 0-.208 7.424c-.072 3.539-.039 5.074-.278 6.15-.241 1.075-.756 1.692-1.495 2.039-.736.344-1.699.42-2.686.28-.988-.139-2-.493-2.848-1.126-.85-.633-1.533-1.544-2.279-2.403-.746-.858-1.555-1.667-2.273-2.079-.718-.41-1.346-.425-1.676.016-.329.441-.363 1.34.015 2.423.378 1.082 1.163 2.349 2.175 3.576 1.014 1.227 2.254 2.417 4.221 3.604 1.969 1.188 4.664 2.371 7.105 2.798 2.441.428 4.628.099 6.781-.813 2.152-.911 4.266-2.404 5.826-3.77 1.559-1.363 2.559-2.598 3.236-3.531s1.031-1.567 1.211-2.27.188-1.475-.273-1.772c-.459-.298-1.381-.12-2.346.557-.965.678-1.971 1.855-3.057 2.71-1.086.854-2.25 1.386-3.25 1.689s-1.834.38-2.57.304c-.732-.076-1.367-.304-1.746-.733-.379-.431-.507-1.064-.633-4.621-.096-2.672-.19-6.992-.267-10.435 1.076 0 2.095-.008 2.897-.026 2.241-.051 2.824-.177 3.229-.442.404-.265.633-.671.76-1.075.125-.406.152-.811.176-1.025.027-.215.051-.241-2.721-.252-1.129-.006-2.724-.01-4.403-.011l-.005-.209a109.09 109.09 0 0 0-.073-2.396 2.396 2.396 0 0 0 1.264-2.099c0-1.326-1.091-2.406-2.427-2.406-1.338 0-2.428 1.08-2.428 2.406a2.4 2.4 0 0 0 1.256 2.095c-.016.286-.03.614-.047 1.001-.02.464-.041 1.01-.063 1.606-1.603 0-3.114.002-4.2.004-2.785.009-2.785.02-2.785.235s0 .633.121 1.035c.12.4.361.787.766 1.04s.977.374 3.209.446c.774.025 1.753.043 2.789.056zm64.761-33.519c-.748-.11-1.885.729-2.93 1.702-1.043.975-1.994 2.08-3.832 4.887-1.836 2.807-4.555 7.314-7.029 12.113s-4.703 9.888-7.641 16.686c-2.936 6.798-6.58 15.304-9.498 21.828-2.918 6.526-5.109 11.069-5.893 13.513-.785 2.442-.164 2.784 1.334.512 1.5-2.271 3.881-7.158 6.613-12.409 2.734-5.254 5.824-10.874 8.887-16.569 3.064-5.696 6.102-11.47 8.912-16.454 2.809-4.988 5.393-9.191 7.443-12.989 2.049-3.796 3.57-7.188 4.152-9.416s.228-3.292-.518-3.404z"
                />
              </svg>
            </Link>
          </Box>

          {isAuthenticated ? (
            <>
              <nav className={classes.nav}>
                <Box mr={2}>
                  <Link color="inherit" className={classes.text} component={RouterLink} to="/">
                    Поиск двигателей
                  </Link>
                </Box>

                {currentUser!.role === "ADMIN" && (
                  <>
                    <Box mr={2}>
                      <Link
                        color="inherit"
                        className={classes.text}
                        component={RouterLink}
                        to="/createEngine"
                      >
                        Добавление двигателя
                      </Link>
                    </Box>
                    <Box>
                      <Link
                        color="inherit"
                        className={classes.text}
                        component={RouterLink}
                        to="/users"
                      >
                        Управление пользователями
                      </Link>
                    </Box>
                  </>
                )}
              </nav>

              <Box style={{ display: "flex", alignItems: "center" }}>
                <div style={{ display: "flex", alignItems: "center" }}>
                  <Box mx={1}>
                    <Typography>
                      {currentUser!.firstName} {currentUser!.lastName}
                    </Typography>
                  </Box>
                  <Box style={{ display: "flex", alignItems: "center" }}>
                    <Typography>({mapRole(currentUser!.role)})</Typography>
                    <Popover informationAboutRole={currentUser!.informationAboutRole} />
                  </Box>
                </div>

                <Box pl={2}>
                  <Button
                    color="inherit"
                    variant="outlined"
                    className={classes.btn}
                    onClick={() => sessionDropped()}
                  >
                    Выйти
                  </Button>
                </Box>
              </Box>
            </>
          ) : (
            <>
              <nav className={classes.nav}>
                <Box pl={2}>
                  <Link color="inherit" className={classes.text} component={RouterLink} to="/">
                    Поиск двигателей
                  </Link>
                </Box>
              </nav>
              <Box pl={2}>
                <Button
                  onClick={handleOpenAuthModal(0)}
                  color="inherit"
                  variant="outlined"
                  className={classes.btn}
                >
                  Войти
                </Button>
              </Box>

              <Box pl={2}></Box>
              <Button
                onClick={handleOpenAuthModal(1)}
                color="inherit"
                variant="outlined"
                className={classes.btn}
              >
                Зарегистрироваться
              </Button>
            </>
          )}
        </Toolbar>
      </AppBar>
      <Divider />
      <AuthTabs />
    </React.Fragment>
  );
};

const usePopoverStyles = makeStyles((theme: Theme) =>
  createStyles({
    popover: {
      pointerEvents: "none",
    },
    paper: {
      padding: theme.spacing(2),
    },
  })
);

const Popover = ({ informationAboutRole }: { informationAboutRole: string[] }) => {
  const classes = usePopoverStyles();
  const [anchorEl, setAnchorEl] = React.useState<HTMLElement | null>(null);

  const handlePopoverOpen = (event: React.MouseEvent<HTMLElement, MouseEvent>) => {
    setAnchorEl(event.currentTarget);
  };

  const handlePopoverClose = () => {
    setAnchorEl(null);
  };

  const open = Boolean(anchorEl);

  return (
    <div>
      <IconButton
        color="primary"
        aria-owns={open ? "mouse-over-popover" : undefined}
        aria-haspopup="true"
        onMouseEnter={handlePopoverOpen}
        onMouseLeave={handlePopoverClose}
      >
        <InfoIcon />
      </IconButton>

      <MaterialUIPopover
        id="mouse-over-popover"
        className={classes.popover}
        classes={{
          paper: classes.paper,
        }}
        open={open}
        anchorEl={anchorEl}
        anchorOrigin={{
          vertical: "bottom",
          horizontal: "left",
        }}
        transformOrigin={{
          vertical: "top",
          horizontal: "left",
        }}
        onClose={handlePopoverClose}
        disableRestoreFocus
      >
        <Box p={2}>
          <Typography variant="h6">Вам доступны следующие действия:</Typography>
          <ul>
            {informationAboutRole.map((information) => (
              <li key={information}>
                <Typography>{information};</Typography>
              </li>
            ))}
          </ul>
        </Box>
      </MaterialUIPopover>
    </div>
  );
};
